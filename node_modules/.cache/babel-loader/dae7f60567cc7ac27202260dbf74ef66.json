{"remainingRequest":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\src\\views\\lib\\file\\preview.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\src\\views\\lib\\file\\preview.vue","mtime":1649828543828},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\babel.config.js","mtime":1648542802000},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJDOi9Vc2Vycy9sbWwvRGVza3RvcC9cdTgyN0VcdTY1ODdcdTY2NkUvXHU1RTk0XHU2MDI1XHU0RThCXHU2NTQ1XHU2QzYwXHU2NTg3XHU2ODYzL0NBVC9DQVQvY29kZS9mcm9udGVuZC93ZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvaW50ZXJvcFJlcXVpcmVEZWZhdWx0LmpzIikuZGVmYXVsdDsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5kZWZhdWx0ID0gdm9pZCAwOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LWJ1ZmZlci5zbGljZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS51aW50OC1hcnJheS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC50eXBlZC1hcnJheS5hdC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmNvcHktd2l0aGluLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZXZlcnkuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maWxsLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmlsdGVyLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuZmluZC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmZpbmQtaW5kZXguanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5mb3ItZWFjaC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmluY2x1ZGVzLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuaW5kZXgtb2YuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5pdGVyYXRvci5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LmpvaW4uanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5sYXN0LWluZGV4LW9mLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkubWFwLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmVkdWNlLXJpZ2h0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkucmV2ZXJzZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNldC5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNsaWNlLmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuc29tZS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnNvcnQuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zdWJhcnJheS5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLWxvY2FsZS1zdHJpbmcuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1zdHJpbmcuanMiKTsKCnZhciBfdnVlc2hvd3BkZiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgidnVlc2hvd3BkZiIpKTsKCnZhciBfYXhpb3MgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KHJlcXVpcmUoImF4aW9zIikpOwoKdmFyIF94bHN4ID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChyZXF1aXJlKCJ4bHN4IikpOwoKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KdmFyIGRvY3ggPSByZXF1aXJlKCJkb2N4LXByZXZpZXciKTsKCnZhciBfZGVmYXVsdCA9IHsKICBuYW1lOiAicHJldmlldyIsCiAgY29tcG9uZW50czogewogICAgdnVlc2hvd3BkZjogX3Z1ZXNob3dwZGYuZGVmYXVsdAogIH0sCiAgcHJvcHM6IFsic2hvd0V4dCIsICJmaWxlVXJsIl0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vRlRQ6Lev5b6ECiAgICAgIC8vRlRQ6aKE6KeI5a+56K+d5qGG5piv5ZCm5omT5byACiAgICAgIGlzc2hvd3BkZjogZmFsc2UsCiAgICAgIGlzU2hvd0ZpbGVXb3JkOiBmYWxzZSwKICAgICAgb3BlblJldmlld0RpYWxvZzogZmFsc2UsCiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIHdvcmtib29rOiB7fSwKICAgICAgZXhjZWxVUkw6ICJodHRwOi8vMTkyLjE2OC4wLjEzMzo5MDAwL2NhdC8yMDIyLzA0LzExLzI5NjJjMzUyLTgxMWMtNDJjZS1iNDRlLWExMzY3N2NmMmU4Ni54bHN4IgogICAgfTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLnJlYWRXb3JrYm9va0Zyb21SZW1vdGVGaWxlKHRoaXMuZXhjZWxVUkwpOwogIH0sCiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgIGRlYnVnZ2VyOwoKICAgIGlmICh0aGlzLnNob3dFeHQgPT0gInBkZiIpIHsKICAgICAgdGhpcy5pc3Nob3dwZGYgPSB0cnVlOwogICAgfSBlbHNlIGlmICh0aGlzLnNob3dFeHQgPT0gImRvYyIpIHsKICAgICAgdGhpcy5pc1Nob3dGaWxlV29yZCA9IHRydWU7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvL+WFs+mXrXBkZumihOiniAogICAgY2xvc2VwZGY6IGZ1bmN0aW9uIGNsb3NlcGRmKCkgewogICAgICB0aGlzLiRlbWl0KCJjbG9zZXBkZiIpOwogICAgICB0aGlzLmlzc2hvd3BkZiA9IGZhbHNlOwogICAgfSwKICAgIC8vcGRm6aKE6KeI5Ye66ZSZCiAgICBwZGZlcnI6IGZ1bmN0aW9uIHBkZmVycihlcnJ1cmwpIHsKICAgICAgY29uc29sZS5sb2coZXJydXJsKTsKICAgIH0sCiAgICAvL+WKoOi9vXdvcmTpooTop4gKICAgIGdldFBkZkNvZGU6IGZ1bmN0aW9uIGdldFBkZkNvZGUoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgKDAsIF9heGlvcy5kZWZhdWx0KSh7CiAgICAgICAgbWV0aG9kOiAiZ2V0IiwKICAgICAgICByZXNwb25zZVR5cGU6ICJibG9iIiwKICAgICAgICB1cmw6IGZpbGVVcmwKICAgICAgfSkudGhlbihmdW5jdGlvbiAoX3JlZikgewogICAgICAgIHZhciBkYXRhID0gX3JlZi5kYXRhOwogICAgICAgIGRvY3gucmVuZGVyQXN5bmMoZGF0YSwgX3RoaXMyLiRyZWZzLmZpbGUpOyAvLyDmuLLmn5PliLDpobXpnaIKICAgICAgfSk7CiAgICB9LAogICAgLy/lr7nor53moYblhbPpl63kuovku7YKICAgIGRpYWxvZ0Nsb3NlOiBmdW5jdGlvbiBkaWFsb2dDbG9zZSgpIHsKICAgICAgdGhpcy5pc1Nob3dGaWxlV29yZCA9IGZhbHNlOwogICAgICB0aGlzLiRlbWl0KCJjbG9zZXBkZiIpOwogICAgfSwKICAgIHJlYWRXb3JrYm9va0Zyb21SZW1vdGVGaWxlOiBmdW5jdGlvbiByZWFkV29ya2Jvb2tGcm9tUmVtb3RlRmlsZSh1cmwpIHsKICAgICAgdmFyIHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpOwogICAgICB4aHIub3BlbigiZ2V0IiwgdXJsLCB0cnVlKTsKICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICJhcnJheWJ1ZmZlciI7CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKHhoci5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgdmFyIGRhdGEgPSBuZXcgVWludDhBcnJheSh4aHIucmVzcG9uc2UpOwoKICAgICAgICAgIHZhciB3b3JrYm9vayA9IF94bHN4LmRlZmF1bHQucmVhZChkYXRhLCB7CiAgICAgICAgICAgIHR5cGU6ICJhcnJheSIKICAgICAgICAgIH0pOwoKICAgICAgICAgIGNvbnNvbGUubG9nKHdvcmtib29rKTsKICAgICAgICAgIHZhciBzaGVldE5hbWVzID0gd29ya2Jvb2suU2hlZXROYW1lczsgLy8g5bel5L2c6KGo5ZCN56ew6ZuG5ZCICgogICAgICAgICAgX3RoaXMud29ya2Jvb2sgPSB3b3JrYm9vazsKCiAgICAgICAgICBfdGhpcy5nZXRUYWJsZShzaGVldE5hbWVzWzBdKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICB4aHIuc2VuZCgpOwogICAgfSwKICAgIGdldFRhYmxlOiBmdW5jdGlvbiBnZXRUYWJsZShzaGVldE5hbWUpIHsKICAgICAgY29uc29sZS5sb2coc2hlZXROYW1lKTsKICAgICAgdmFyIHdvcmtzaGVldCA9IHRoaXMud29ya2Jvb2suU2hlZXRzW3NoZWV0TmFtZV07CiAgICAgIHRoaXMudGFibGVEYXRhID0gX3hsc3guZGVmYXVsdC51dGlscy5zaGVldF90b19qc29uKHdvcmtzaGVldCk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMudGFibGVEYXRhKTsKICAgIH0KICB9Cn07CmV4cG9ydHMuZGVmYXVsdCA9IF9kZWZhdWx0Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;;AACA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACA;;eACA;AACAA,iBADA;AAEAC;AAAAC;AAAA,GAFA;AAGAC,+BAHA;AAIAC,MAJA,kBAIA;AACA;AACA;AACA;AACAC,sBAHA;AAIAC,2BAJA;AAKAC,6BALA;AAMAC,mBANA;AAOAC,kBAPA;AAQAC;AARA;AAUA,GAfA;AAgBAC,SAhBA,qBAgBA;AACA;AACA,GAlBA;AAmBAC,SAnBA,qBAmBA;AACA;;AACA;AACA;AACA,KAFA,MAEA;AACA;AACA;AACA,GA1BA;AA4BAC;AACA;AACAC,YAFA,sBAEA;AACA;AACA;AACA,KALA;AAMA;AACAC,UAPA,kBAOAC,MAPA,EAOA;AACAC;AACA,KATA;AAUA;AACAC,cAXA,wBAWA;AAAA;;AACA;AACAC,qBADA;AAEAC,4BAFA;AAGAC;AAHA,SAIAC,IAJA,CAIA;AAAA;AACAC,kDADA,CACA;AACA,OANA;AAOA,KAnBA;AAoBA;AACAC,eArBA,yBAqBA;AACA;AACA;AACA,KAxBA;AAyBAC;AACA;AACAC;AACAA;;AACA;;AACAA;AACA;AACA;;AACA;AAAAC;AAAA;;AACAV;AAEA,+CALA,CAKA;;AACAW;;AACAA;AACA;AACA,OAVA;;AAWAF;AACA,KA1CA;AA2CAG,YA3CA,oBA2CAC,SA3CA,EA2CA;AACAb;AACA;AACA;AACAA;AACA;AAhDA;AA5BA,C","names":["name","components","vueshowpdf","props","data","isshowpdf","isShowFileWord","openReviewDialog","tableData","workbook","excelURL","mounted","created","methods","closepdf","pdferr","errurl","console","getPdfCode","method","responseType","url","then","docx","dialogClose","readWorkbookFromRemoteFile","xhr","type","_this","getTable","sheetName"],"sourceRoot":"src/views/lib/file","sources":["preview.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!--FTP预览对话框-->\r\n    <vueshowpdf\r\n      @closepdf=\"closepdf\"\r\n      v-model=\"isshowpdf\"\r\n      :pdfurl=\"fileUrl\"\r\n      @pdferr=\"pdferr\"\r\n      :maxscale=\"4\"\r\n      :minscale=\"0.6\"\r\n      :scale=\"1.0\"\r\n    >\r\n    </vueshowpdf>\r\n    <!--word文件预览-->\r\n    <el-dialog\r\n      :title=\"title\"\r\n      :visible.sync=\"isShowFileWord\"\r\n      @close=\"dialogClose\"\r\n      width=\"60%\"\r\n      append-to-body\r\n    >\r\n      <div ref=\"file\"></div>\r\n      <div id=\"table\">\r\n        <el-table :data=\"tableData\" style=\"width: 100%\">\r\n          <el-table-column\r\n            v-for=\"(value, key, index) in tableData[2]\"\r\n            :key=\"index\"\r\n            :prop=\"key\"\r\n            :label=\"key\"\r\n          ></el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport vueshowpdf from \"vueshowpdf\";\r\nimport Axios from \"axios\";\r\nimport XLSX from \"xlsx\";\r\nlet docx = require(\"docx-preview\");\r\nexport default {\r\n  name: \"preview\",\r\n  components: { vueshowpdf },\r\n  props: [\"showExt\", \"fileUrl\"],\r\n  data() {\r\n    return {\r\n      //FTP路径\r\n      //FTP预览对话框是否打开\r\n      isshowpdf: false,\r\n      isShowFileWord: false,\r\n      openReviewDialog: false,\r\n      tableData: [],\r\n      workbook: {},\r\n      excelURL: \"http://192.168.0.133:9000/cat/2022/04/11/2962c352-811c-42ce-b44e-a13677cf2e86.xlsx\",\r\n    };\r\n  },\r\n  mounted() {\r\n    this.readWorkbookFromRemoteFile(this.excelURL);\r\n  },\r\n  created() {\r\n    debugger;\r\n    if (this.showExt == \"pdf\") {\r\n      this.isshowpdf = true;\r\n    } else if (this.showExt == \"doc\") {\r\n      this.isShowFileWord = true;\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    //关闭pdf预览\r\n    closepdf() {\r\n      this.$emit(\"closepdf\");\r\n      this.isshowpdf = false;\r\n    },\r\n    //pdf预览出错\r\n    pdferr(errurl) {\r\n      console.log(errurl);\r\n    },\r\n    //加载word预览\r\n    getPdfCode() {\r\n      Axios({\r\n        method: \"get\",\r\n        responseType: \"blob\",\r\n        url: fileUrl,\r\n      }).then(({ data }) => {\r\n        docx.renderAsync(data, this.$refs.file); // 渲染到页面\r\n      });\r\n    },\r\n    //对话框关闭事件\r\n    dialogClose() {\r\n      this.isShowFileWord = false;\r\n      this.$emit(\"closepdf\");\r\n    },\r\n    readWorkbookFromRemoteFile: function (url) {\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open(\"get\", url, true);\r\n      xhr.responseType = \"arraybuffer\";\r\n      let _this = this;\r\n      xhr.onload = function (e) {\r\n        if (xhr.status === 200) {\r\n          var data = new Uint8Array(xhr.response);\r\n          var workbook = XLSX.read(data, { type: \"array\" });\r\n          console.log(workbook);\r\n\r\n          var sheetNames = workbook.SheetNames; // 工作表名称集合\r\n          _this.workbook = workbook;\r\n          _this.getTable(sheetNames[0]);\r\n        }\r\n      };\r\n      xhr.send();\r\n    },\r\n    getTable(sheetName) {\r\n      console.log(sheetName);\r\n      var worksheet = this.workbook.Sheets[sheetName];\r\n      this.tableData = XLSX.utils.sheet_to_json(worksheet);\r\n      console.log(this.tableData);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>"]}]}