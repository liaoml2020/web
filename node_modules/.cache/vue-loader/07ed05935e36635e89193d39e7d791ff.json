{"remainingRequest":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\src\\views\\lib\\file\\preview.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\src\\views\\lib\\file\\preview.vue","mtime":1649828543828},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\lml\\Desktop\\艾文普\\应急事故池文档\\CAT\\CAT\\code\\frontend\\web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgdnVlc2hvd3BkZiBmcm9tICJ2dWVzaG93cGRmIjsNCmltcG9ydCBBeGlvcyBmcm9tICJheGlvcyI7DQppbXBvcnQgWExTWCBmcm9tICJ4bHN4IjsNCmxldCBkb2N4ID0gcmVxdWlyZSgiZG9jeC1wcmV2aWV3Iik7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJwcmV2aWV3IiwNCiAgY29tcG9uZW50czogeyB2dWVzaG93cGRmIH0sDQogIHByb3BzOiBbInNob3dFeHQiLCAiZmlsZVVybCJdLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICAvL0ZUUOi3r+W+hA0KICAgICAgLy9GVFDpooTop4jlr7nor53moYbmmK/lkKbmiZPlvIANCiAgICAgIGlzc2hvd3BkZjogZmFsc2UsDQogICAgICBpc1Nob3dGaWxlV29yZDogZmFsc2UsDQogICAgICBvcGVuUmV2aWV3RGlhbG9nOiBmYWxzZSwNCiAgICAgIHRhYmxlRGF0YTogW10sDQogICAgICB3b3JrYm9vazoge30sDQogICAgICBleGNlbFVSTDogImh0dHA6Ly8xOTIuMTY4LjAuMTMzOjkwMDAvY2F0LzIwMjIvMDQvMTEvMjk2MmMzNTItODExYy00MmNlLWI0NGUtYTEzNjc3Y2YyZTg2Lnhsc3giLA0KICAgIH07DQogIH0sDQogIG1vdW50ZWQoKSB7DQogICAgdGhpcy5yZWFkV29ya2Jvb2tGcm9tUmVtb3RlRmlsZSh0aGlzLmV4Y2VsVVJMKTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBkZWJ1Z2dlcjsNCiAgICBpZiAodGhpcy5zaG93RXh0ID09ICJwZGYiKSB7DQogICAgICB0aGlzLmlzc2hvd3BkZiA9IHRydWU7DQogICAgfSBlbHNlIGlmICh0aGlzLnNob3dFeHQgPT0gImRvYyIpIHsNCiAgICAgIHRoaXMuaXNTaG93RmlsZVdvcmQgPSB0cnVlOw0KICAgIH0NCiAgfSwNCg0KICBtZXRob2RzOiB7DQogICAgLy/lhbPpl61wZGbpooTop4gNCiAgICBjbG9zZXBkZigpIHsNCiAgICAgIHRoaXMuJGVtaXQoImNsb3NlcGRmIik7DQogICAgICB0aGlzLmlzc2hvd3BkZiA9IGZhbHNlOw0KICAgIH0sDQogICAgLy9wZGbpooTop4jlh7rplJkNCiAgICBwZGZlcnIoZXJydXJsKSB7DQogICAgICBjb25zb2xlLmxvZyhlcnJ1cmwpOw0KICAgIH0sDQogICAgLy/liqDovb13b3Jk6aKE6KeIDQogICAgZ2V0UGRmQ29kZSgpIHsNCiAgICAgIEF4aW9zKHsNCiAgICAgICAgbWV0aG9kOiAiZ2V0IiwNCiAgICAgICAgcmVzcG9uc2VUeXBlOiAiYmxvYiIsDQogICAgICAgIHVybDogZmlsZVVybCwNCiAgICAgIH0pLnRoZW4oKHsgZGF0YSB9KSA9PiB7DQogICAgICAgIGRvY3gucmVuZGVyQXN5bmMoZGF0YSwgdGhpcy4kcmVmcy5maWxlKTsgLy8g5riy5p+T5Yiw6aG16Z2iDQogICAgICB9KTsNCiAgICB9LA0KICAgIC8v5a+56K+d5qGG5YWz6Zet5LqL5Lu2DQogICAgZGlhbG9nQ2xvc2UoKSB7DQogICAgICB0aGlzLmlzU2hvd0ZpbGVXb3JkID0gZmFsc2U7DQogICAgICB0aGlzLiRlbWl0KCJjbG9zZXBkZiIpOw0KICAgIH0sDQogICAgcmVhZFdvcmtib29rRnJvbVJlbW90ZUZpbGU6IGZ1bmN0aW9uICh1cmwpIHsNCiAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTsNCiAgICAgIHhoci5vcGVuKCJnZXQiLCB1cmwsIHRydWUpOw0KICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICJhcnJheWJ1ZmZlciI7DQogICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KICAgICAgeGhyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHsNCiAgICAgICAgICB2YXIgZGF0YSA9IG5ldyBVaW50OEFycmF5KHhoci5yZXNwb25zZSk7DQogICAgICAgICAgdmFyIHdvcmtib29rID0gWExTWC5yZWFkKGRhdGEsIHsgdHlwZTogImFycmF5IiB9KTsNCiAgICAgICAgICBjb25zb2xlLmxvZyh3b3JrYm9vayk7DQoNCiAgICAgICAgICB2YXIgc2hlZXROYW1lcyA9IHdvcmtib29rLlNoZWV0TmFtZXM7IC8vIOW3peS9nOihqOWQjeensOmbhuWQiA0KICAgICAgICAgIF90aGlzLndvcmtib29rID0gd29ya2Jvb2s7DQogICAgICAgICAgX3RoaXMuZ2V0VGFibGUoc2hlZXROYW1lc1swXSk7DQogICAgICAgIH0NCiAgICAgIH07DQogICAgICB4aHIuc2VuZCgpOw0KICAgIH0sDQogICAgZ2V0VGFibGUoc2hlZXROYW1lKSB7DQogICAgICBjb25zb2xlLmxvZyhzaGVldE5hbWUpOw0KICAgICAgdmFyIHdvcmtzaGVldCA9IHRoaXMud29ya2Jvb2suU2hlZXRzW3NoZWV0TmFtZV07DQogICAgICB0aGlzLnRhYmxlRGF0YSA9IFhMU1gudXRpbHMuc2hlZXRfdG9fanNvbih3b3Jrc2hlZXQpOw0KICAgICAgY29uc29sZS5sb2codGhpcy50YWJsZURhdGEpOw0KICAgIH0sDQogIH0sDQp9Ow0K"},{"version":3,"sources":["preview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"preview.vue","sourceRoot":"src/views/lib/file","sourcesContent":["<template>\r\n  <div>\r\n    <!--FTP预览对话框-->\r\n    <vueshowpdf\r\n      @closepdf=\"closepdf\"\r\n      v-model=\"isshowpdf\"\r\n      :pdfurl=\"fileUrl\"\r\n      @pdferr=\"pdferr\"\r\n      :maxscale=\"4\"\r\n      :minscale=\"0.6\"\r\n      :scale=\"1.0\"\r\n    >\r\n    </vueshowpdf>\r\n    <!--word文件预览-->\r\n    <el-dialog\r\n      :title=\"title\"\r\n      :visible.sync=\"isShowFileWord\"\r\n      @close=\"dialogClose\"\r\n      width=\"60%\"\r\n      append-to-body\r\n    >\r\n      <div ref=\"file\"></div>\r\n      <div id=\"table\">\r\n        <el-table :data=\"tableData\" style=\"width: 100%\">\r\n          <el-table-column\r\n            v-for=\"(value, key, index) in tableData[2]\"\r\n            :key=\"index\"\r\n            :prop=\"key\"\r\n            :label=\"key\"\r\n          ></el-table-column>\r\n        </el-table>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport vueshowpdf from \"vueshowpdf\";\r\nimport Axios from \"axios\";\r\nimport XLSX from \"xlsx\";\r\nlet docx = require(\"docx-preview\");\r\nexport default {\r\n  name: \"preview\",\r\n  components: { vueshowpdf },\r\n  props: [\"showExt\", \"fileUrl\"],\r\n  data() {\r\n    return {\r\n      //FTP路径\r\n      //FTP预览对话框是否打开\r\n      isshowpdf: false,\r\n      isShowFileWord: false,\r\n      openReviewDialog: false,\r\n      tableData: [],\r\n      workbook: {},\r\n      excelURL: \"http://192.168.0.133:9000/cat/2022/04/11/2962c352-811c-42ce-b44e-a13677cf2e86.xlsx\",\r\n    };\r\n  },\r\n  mounted() {\r\n    this.readWorkbookFromRemoteFile(this.excelURL);\r\n  },\r\n  created() {\r\n    debugger;\r\n    if (this.showExt == \"pdf\") {\r\n      this.isshowpdf = true;\r\n    } else if (this.showExt == \"doc\") {\r\n      this.isShowFileWord = true;\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    //关闭pdf预览\r\n    closepdf() {\r\n      this.$emit(\"closepdf\");\r\n      this.isshowpdf = false;\r\n    },\r\n    //pdf预览出错\r\n    pdferr(errurl) {\r\n      console.log(errurl);\r\n    },\r\n    //加载word预览\r\n    getPdfCode() {\r\n      Axios({\r\n        method: \"get\",\r\n        responseType: \"blob\",\r\n        url: fileUrl,\r\n      }).then(({ data }) => {\r\n        docx.renderAsync(data, this.$refs.file); // 渲染到页面\r\n      });\r\n    },\r\n    //对话框关闭事件\r\n    dialogClose() {\r\n      this.isShowFileWord = false;\r\n      this.$emit(\"closepdf\");\r\n    },\r\n    readWorkbookFromRemoteFile: function (url) {\r\n      var xhr = new XMLHttpRequest();\r\n      xhr.open(\"get\", url, true);\r\n      xhr.responseType = \"arraybuffer\";\r\n      let _this = this;\r\n      xhr.onload = function (e) {\r\n        if (xhr.status === 200) {\r\n          var data = new Uint8Array(xhr.response);\r\n          var workbook = XLSX.read(data, { type: \"array\" });\r\n          console.log(workbook);\r\n\r\n          var sheetNames = workbook.SheetNames; // 工作表名称集合\r\n          _this.workbook = workbook;\r\n          _this.getTable(sheetNames[0]);\r\n        }\r\n      };\r\n      xhr.send();\r\n    },\r\n    getTable(sheetName) {\r\n      console.log(sheetName);\r\n      var worksheet = this.workbook.Sheets[sheetName];\r\n      this.tableData = XLSX.utils.sheet_to_json(worksheet);\r\n      console.log(this.tableData);\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n</style>"]}]}